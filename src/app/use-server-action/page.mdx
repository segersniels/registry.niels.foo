import Source from "@/components/source";

# useServerAction

The `useServerAction` hook simplifies server action management in Next.js client components.
It uses SWR for efficient data fetching, offers conditional execution, and provides easy access
to loading states, errors, and data. This TypeScript-friendly hook streamlines the process of
integrating server actions into React components with minimal boilerplate.

## Usage

```tsx
"use client";

import { useEffect, useState } from "react";

import useServerAction from "@/hooks/use-server-action";

export default function Example({ name }: { name: string }) {
  const [shouldFetch, setShouldFetch] = useState(false);
  const { data, error, isLoading, mutate } = useServerAction(
    async () => {
      return `Hello ${name}!`;
    },
    [name],
    { shouldFetch }
  );

  // Refresh the data every second
  useEffect(() => {
    const interval = setInterval(() => {
      mutate();
    }, 1000);

    return () => clearInterval(interval);
  }, [mutate]);

  // Conditionally control whether to start fetching the data
  useEffect(() => {
    const timer = setTimeout(() => {
      setShouldFetch(true);
    }, 5000);

    return () => clearTimeout(timer);
  }, []);

  if (isLoading) {
    return <div>Loading...</div>;
  }

  if (error) {
    return <div>Error: {error.message}</div>;
  }

  return <div>{data}</div>;
}
```

## Installation

```bash
npx shadcn add "https://registry.niels.foo/use-server-action.json"
```

## Source

<Source name="use-server-action" />
